import numpy as np
import pandas as pd

import statsmodels
from statsmodels.tsa.stattools import coint

def conv_to_float(n):
    if type(n)==int or type(n)==float:
        return float(n)
    l = n.split('.')
    if(len(l)==1):
        return float(l[0])
    m = l[1]+"."+l[-2]
    return float(m)


df = pd.read_csv('merge_oil.csv')

X = list(df["Price"])
X = [float(i) for i in X]
Y = list(df["IOC_Open"])
Y = [conv_to_float(i) for i in Y]

score, pvalue, _ = coint(X,Y)

print(pvalue)

Y = list(df["ONGC_Open"])
Y = [conv_to_float(i) for i in Y]

score, pvalue, _ = coint(X,Y)

print(pvalue)

Y = list(df["TCI_Open"])
Y = [conv_to_float(i) for i in Y]

score, pvalue, _ = coint(X,Y)

print(pvalue)


X = list(df["ONGC_Open"])
X = [conv_to_float(i) for i in X]
Y = list(df["TCI_Open"])
Y = [conv_to_float(i) for i in Y]

score, pvalue, _ = coint(X,Y)

print(pvalue)


X = list(df["IOC_Open"])
X = [conv_to_float(i) for i in X]
Y = list(df["TCI_Open"])
Y = [conv_to_float(i) for i in Y]

score, pvalue, _ = coint(X,Y)

print(pvalue)


X = list(df["ONGC_Open"])
X = [conv_to_float(i) for i in X]
Y = list(df["IOC_Open"])
Y = [conv_to_float(i) for i in Y]

score, pvalue, _ = coint(X,Y)

print(pvalue)


X = list(df["Open"])
X = [conv_to_float(i) for i in X]
Y = list(df["High"])
Y = [conv_to_float(i) for i in Y]

score, pvalue, _ = coint(X,Y)

print(pvalue)


actual = [3202.9998, 3265.0, 3310.0, 3340.9998, 3329.0, 3178.0, 3212.9998, 3259.0, 3202.9998, 3127.0002, 3159.0, 3081.0, 3051.9998, 3090.0, 2966.0, 2945.0, 2958.9998, 2988.0, 2985.0, 2873.0, 2877.0, 2879.0, 2860.9998, 2813.0, 2741.0, 2776.0, 2777.0, 2801.0, 2860.0, 2892.0, 2918.0, 2968.0, 3043.0, 3068.0, 2938.0, 2947.0, 2863.0, 2875.9998, 2912.0, 2948.9998, 2963.9998, 2990.0, 2968.0, 2973.0, 3028.0, 3036.9998, 2965.0, 2997.0, 3090.0, 3132.0002, 3161.0, 3192.0, 3183.0, 3134.9998, 3147.0, 3143.0, 3149.0, 3144.0, 3139.0, 3157.0, 3128.0, 3127.0002, 3070.0, 3008.0, 3021.0, 3104.0, 3038.0, 3072.0002, 3107.0002, 3041.0, 3058.0, 2970.0, 2962.0, 2957.0, 3038.0, 3021.0, 3049.0, 3122.0002, 3154.9998, 3143.0, 3045.0, 3073.0, 3092.0002, 3162.0, 3215.0002, 3191.0, 3207.9998, 3171.0, 3286.0, 3295.0, 3287.0, 3406.0002, 3402.0, 3416.0002, 3373.0, 3373.0, 3310.9998, 3266.0, 3313.0002, 3240.0, 3256.0, 3330.9998, 3347.0, 3296.0, 3310.0, 3363.0, 3353.0, 3385.0, 3359.0, 3372.0, 3383.0, 3431.0002, 3384.0, 3428.0, 3501.0, 3513.0, 3528.0, 3500.0, 3520.0, 3579.0, 3691.0, 3734.0, 3695.0002, 3737.9998, 3712.0, 3720.0002, 3639.0, 3621.0, 3599.9998, 3661.0, 3663.0, 3678.0, 3747.0, 3798.0002, 3807.0, 3757.0, 3737.9998, 3678.0, 3687.0, 3762.0, 3714.0, 3724.0, 3637.0, 3657.0, 3692.0, 3720.0002, 3692.0, 3656.0, 3651.0, 3669.0, 3648.0, 3697.9998, 3716.0, 3732.0, 3737.0, 3833.0, 3818.0002, 3820.0, 3850.0, 3829.0, 3824.0, 3903.0, 3921.0, 3887.0, 3906.0002, 4003.0, 4036.0, 4100.0, 4065.0, 4116.0, 4086.0, 4084.9998, 4088.0, 4036.9998, 4045.0, 4110.0, 4136.0, 4190.0, 4177.0, 4106.0, 4112.0, 4195.0, 4186.0, 4103.0, 4099.0, 3959.0002, 3931.0, 3807.0, 3842.0, 3813.0002, 3823.0, 3911.0002, 3941.0, 4036.9998, 4034.0, 3999.0002, 4086.0, 4125.0, 4155.0, 4122.0, 4093.0, 3983.0, 3995.0, 4075.0, 4063.0, 3960.0, 3943.0, 4016.9998, 3977.0, 3918.9998, 3948.0, 3984.0002, 4050.0, 4039.0, 4159.0, 4251.0, 4201.0, 4266.0, 4247.0, 4232.0, 4185.0, 4234.0, 4112.0, 4127.0, 4111.0, 4115.0, 4029.0, 4116.0, 4248.0, 4354.0, 4362.0, 4401.0, 4351.0, 4348.0, 4470.0, 4495.0, 4531.0, 4565.0, 4530.0, 4563.0, 4558.0, 4547.0, 4583.0, 4487.0, 4512.0, 4571.0, 4668.0, 4749.0, 4623.0, 4799.0, 4757.0, 4793.0, 4794.0, 4850.0, 4820.0, 4832.0, 4855.0, 4919.0, 4929.0, 4913.0, 4859.0, 4597.0, 4508.0, 4527.0, 4614.0, 4517.0, 4428.0, 4351.0, 4392.0, 4342.0, 4443.0, 4445.0, 4472.0, 4478.0, 4506.0, 4517.0, 4435.0, 4481.0, 4419.0, 4486.0, 4496.0, 4672.0, 4658.0, 4815.0, 5028.0, 5075.0, 5086.0, 5109.0, 5080.0, 5126.0, 5039.0, 5075.0, 5049.0, 5071.0, 4900.0, 4780.0, 4884.0, 4642.0, 4669.0, 4699.0, 4799.0, 4707.0, 4690.0, 4745.0, 4778.0, 4800.0, 4714.0, 4824.0, 4734.0, 4629.0, 4744.0, 4686.0, 4767.0, 4762.0, 4570.0, 4602.0, 4674.0, 4643.0, 4712.0, 4583.0, 4598.0, 4633.0, 4617.0, 4763.0, 4774.0, 4804.0, 4826.0, 4809.0, 4926.0, 4999.0, 4959.0, 5012.0, 5012.0, 4934.0, 4884.0, 4883.0, 4916.0, 5044.0, 5085.0, 4918.0, 4950.0, 4995.0, 5055.0, 5152.0, 5069.0]

#pred_extra = [3204.489, 3252.451, 3332.209, 3382.6648, 3394.4558, 3383.1438, 3252.129, 3228.753, 3310.6511, 3262.0933, 3175.8079, 3188.836, 3106.6812, 3110.476, 3110.0889, 3034.507, 2987.048, 2999.49, 3038.082, 3033.8591, 2940.099, 2952.429, 2967.355, 2960.683, 2912.4565, 2828.528, 2857.48, 2849.9229, 2882.8044, 2927.077, 2947.2666, 2997.2864, 3038.4128, 3097.0637, 3134.9248, 3030.8743, 3027.9119, 2926.8389, 2940.5786, 2967.1494, 3024.4336, 3031.045, 3063.2214, 3071.118, 3059.363, 3106.6187, 3133.0105, 3068.256, 3065.4055, 3152.3066, 3204.4006, 3215.5332, 3259.549, 3254.9644, 3218.3596, 3184.72, 3209.808, 3202.7373, 3194.913, 3201.324, 3217.3313, 3201.1528, 3178.617, 3146.812, 3089.7883, 3087.1304, 3146.9492, 3128.0725, 3144.7463, 3167.367, 3131.793, 3159.0654, 3070.9956, 3041.5598, 3042.4863, 3091.879, 3092.5925, 3141.0708, 3189.6448, 3232.8955, 3216.1208, 3163.269, 3153.745, 3174.5378, 3236.6528, 3298.011, 3282.804, 3289.8513, 3281.5208, 3363.6982, 3364.7422, 3370.5054, 3454.2163, 3469.096, 3484.9438, 3462.939, 3456.866, 3391.385, 3349.2139, 3389.7512, 3342.4277, 3343.577, 3392.1477, 3423.8733, 3375.133, 3410.7344, 3453.523, 3445.7932, 3494.2578, 3488.2383, 3475.4636, 3493.6194, 3509.4348, 3499.102, 3540.8157, 3597.6355, 3628.6145, 3641.4326, 3624.4702, 3632.8508, 3677.057, 3768.3577, 3821.9592, 3794.5884, 3824.1814, 3825.5251, 3831.2043, 3766.967, 3733.6968, 3724.1165, 3756.6194, 3788.9834, 3798.62, 3851.5283, 3903.4214, 3915.173, 3862.6848, 3838.4062, 3791.049, 3800.1667, 3865.4216, 3827.4036, 3824.6045, 3762.3037, 3756.7468, 3795.7456, 3818.066, 3820.9702, 3785.688, 3754.4666, 3798.6714, 3798.3306, 3830.5996, 3845.3838, 3854.492, 3870.667, 3946.3855, 3960.7776, 3965.1313, 3990.1826, 3997.993, 3991.4526, 4032.9604, 4073.6418, 4046.0593, 4068.186, 4129.4395, 4180.869, 4229.274, 4191.478, 4255.984, 4235.111, 4233.1504, 4240.567, 4204.3115, 4215.9414, 4254.919, 4274.137, 4344.2764, 4349.121, 4251.1367, 4229.748, 4298.1865, 4306.356, 4221.5464, 4196.75, 4089.8486, 4052.5059, 3957.496, 3979.0386, 3940.2417, 3928.6714, 4018.4033, 4073.4556, 4183.9707, 4160.98, 4132.9795, 4184.5615, 4239.198, 4261.7373, 4240.161, 4201.666, 4106.888, 4108.7812, 4164.047, 4190.179, 4088.0776, 4070.0403, 4112.935, 4111.4863, 4057.1504, 4053.5364, 4111.906, 4176.7656, 4176.54, 4289.2847, 4364.3184, 4354.823, 4383.2427, 4389.664, 4374.9434, 4310.8755, 4363.402, 4283.0415, 4246.951, 4214.9067, 4267.6196, 4198.1553, 4256.8223, 4374.8535, 4464.854, 4500.3096, 4549.633, 4517.6924, 4511.0796, 4614.674, 4678.784, 4690.83, 4707.153, 4706.1997, 4704.3423, 4715.8833, 4704.371, 4705.343, 4686.153, 4682.258, 4714.616, 4812.17, 4919.3364, 4794.993, 4943.6377, 4963.841, 4985.342, 4972.461, 5011.618, 5006.3867, 5035.109, 5049.2544, 5094.0586, 5103.4854, 5067.7266, 5022.2075, 4807.161, 4684.56, 4683.417, 4723.0337, 4675.842, 4597.816, 4509.5054, 4525.268, 4501.7793, 4576.5376, 4601.828, 4599.855, 4638.701, 4635.81, 4665.7563, 4610.075, 4589.3945, 4584.884, 4638.2974, 4625.463, 4785.0854, 4855.1226, 4951.8345, 5175.2812, 5246.4263, 5266.794, 5270.433, 5268.768, 5318.918, 5254.689, 5240.328, 5230.109, 5260.3135, 5120.619, 4946.0977, 5027.7275, 4871.409, 4818.3335, 4842.85, 4938.506, 4860.614, 4875.5103, 4896.7886, 4921.379, 4964.6, 4901.01, 4954.456, 4917.5376, 4806.479, 4874.819, 4858.938, 4919.812, 4916.0913, 4777.707, 4759.863, 4804.4243, 4797.248, 4856.156, 4737.837, 4760.369, 4773.2197, 4768.1226, 4893.192, 4934.0874, 4982.9536, 4992.954, 4992.9067, 5073.581, 5158.7124, 5147.2993, 5166.1533, 5186.969, 5094.7466, 5045.7207, 5024.987, 5080.402, 5158.6104, 5241.994, 5130.0215, 5110.0527, 5166.61, 5202.1196, 5304.525]
pred_extra = [3155.1035, 3194.0376, 3265.9148, 3318.4082, 3327.1624, 3325.9795, 3209.555, 3180.2837, 3244.7732, 3205.811, 3129.0398, 3146.667, 3068.429, 3065.993, 3070.6648, 2993.8635, 2950.4685, 2957.4927, 2993.177, 2988.562, 2905.856, 2906.6938, 2916.8308, 2908.7673, 2866.507, 2793.5454, 2814.8604, 2809.3843, 2832.5151, 2881.4, 2905.037, 2950.5042, 2986.3022, 3043.1917, 3077.9465, 2984.4878, 2983.6643, 2889.3945, 2898.915, 2925.6328, 2982.7668, 2985.742, 3018.6565, 3021.7124, 3011.649, 3052.3853, 3081.3923, 3017.331, 3016.769, 3096.8018, 3152.4023, 3165.4048, 3200.0896, 3199.9998, 3168.3586, 3143.7202, 3163.8066, 3155.0637, 3148.0327, 3154.9402, 3169.3147, 3158.0513, 3130.469, 3100.137, 3042.8792, 3037.207, 3094.6577, 3072.7292, 3098.2712, 3115.7478, 3080.114, 3097.5945, 3020.4758, 2997.96, 2995.865, 3042.4563, 3043.9229, 3079.2334, 3133.244, 3176.832, 3165.189, 3104.6729, 3099.53, 3122.266, 3178.401, 3234.6235, 3222.1287, 3231.5396, 3217.215, 3301.759, 3302.1255, 3304.1394, 3379.2192, 3402.9639, 3418.0298, 3397.9224, 3390.7537, 3324.3823, 3285.7932, 3320.817, 3275.4685, 3272.5137, 3321.6523, 3354.9702, 3311.7607, 3345.083, 3381.443, 3374.7468, 3413.3184, 3392.588, 3388.9446, 3418.0317, 3436.6655, 3425.031, 3454.9946, 3511.6016, 3546.346, 3555.5002, 3545.0938, 3548.3672, 3592.7, 3684.3113, 3739.9583, 3715.6262, 3736.5532, 3731.7458, 3737.2478, 3675.916, 3643.4302, 3632.9087, 3663.0488, 3695.7922, 3709.9211, 3762.12, 3805.1765, 3818.519, 3772.5264, 3749.9016, 3711.06, 3722.2732, 3778.5337, 3739.0283, 3735.965, 3676.4768, 3666.8323, 3710.424, 3730.9966, 3737.6428, 3701.239, 3672.105, 3709.998, 3703.901, 3737.7507, 3750.5955, 3763.6738, 3772.5903, 3846.5503, 3862.2603, 3861.1477, 3889.503, 3874.7544, 3892.871, 3933.1392, 3975.3643, 3945.848, 3965.285, 4028.1633, 4080.384, 4126.2104, 4089.622, 4143.8794, 4128.6123, 4121.8696, 4132.978, 4092.9338, 4107.998, 4149.0586, 4172.166, 4237.597, 4235.5664, 4149.7573, 4133.8657, 4198.35, 4206.637, 4129.6055, 4108.981, 4011.933, 3967.2185, 3866.7495, 3888.5195, 3841.021, 3844.1267, 3929.4568, 3972.346, 4070.4224, 4062.185, 4030.407, 4083.4614, 4130.903, 4157.77, 4140.941, 4109.96, 4017.692, 4002.2886, 4067.7883, 4094.0254, 4006.4563, 3975.8328, 4011.9326, 4011.9854, 3971.1104, 3973.53, 4013.7068, 4068.2266, 4063.347, 4183.7163, 4256.835, 4247.3467, 4277.3384, 4281.3857, 4271.957, 4214.2544, 4241.075, 4177.3647, 4142.5293, 4124.0234, 4165.035, 4098.151, 4144.047, 4259.981, 4360.5605, 4387.1577, 4431.503, 4392.683, 4383.799, 4480.907, 4542.5586, 4557.128, 4570.0293, 4577.749, 4575.575, 4584.4688, 4565.1064, 4578.3657, 4537.1914, 4552.613, 4579.932, 4671.479, 4764.718, 4670.105, 4789.8936, 4812.5693, 4827.582, 4810.143, 4863.085, 4851.574, 4879.2954, 4882.259, 4922.8613, 4944.2754, 4911.1694, 4864.9897, 4665.532, 4536.936, 4545.254, 4576.8975, 4543.695, 4465.85, 4380.587, 4394.287, 4376.4097, 4434.4087, 4460.3647, 4458.2695, 4496.917, 4497.8423, 4522.1255, 4464.9517, 4443.9517, 4438.1636, 4507.4785, 4487.499, 4645.1235, 4705.7993, 4798.0405, 5006.3887, 5080.4883, 5091.1826, 5102.6787, 5109.6816, 5136.8975, 5088.943, 5070.1553, 5065.4937, 5095.243, 4960.4956, 4804.2856, 4862.6455, 4709.729, 4670.167, 4682.3257, 4769.031, 4705.32, 4720.564, 4739.4106, 4770.2686, 4801.869, 4743.14, 4790.3945, 4759.6665, 4658.8296, 4715.5815, 4706.4385, 4763.7554, 4761.5854, 4633.8936, 4608.7075, 4644.9355, 4645.608, 4706.2817, 4577.6123, 4599.0205, 4610.137, 4607.6685, 4722.227, 4766.3965, 4811.2686, 4819.456, 4824.526, 4901.457, 4975.467, 4966.065, 4974.3853, 5020.9307, 4927.3887, 4877.0215, 4851.8296, 4904.832, 4973.8027, 5067.8857, 4936.854, 4937.417, 4984.142, 5019.9097, 5114.304]

pred_normal = [3136.928, 3180.1829, 3248.783, 3305.713, 3313.1929, 3326.8132, 3220.2856, 3180.0154, 3230.907, 3190.7673, 3124.8838, 3151.0718, 3066.857, 3060.9229, 3074.3232, 2992.9443, 2943.8467, 2945.1465, 2984.2588, 2971.7053, 2889.324, 2878.1824, 2876.767, 2863.5632, 2829.9531, 2770.2527, 2784.0232, 2778.094, 2795.8013, 2855.0671, 2881.5962, 2922.456, 2956.7893, 3025.8594, 3051.9438, 2959.2725, 2963.2053, 2867.1995, 2873.9863, 2901.5059, 2959.0276, 2955.6863, 2986.3306, 2979.2979, 2975.741, 3015.9812, 3048.3743, 2975.8694, 2983.1245, 3070.9578, 3127.1658, 3144.119, 3170.7458, 3178.0833, 3155.303, 3130.0945, 3144.9058, 3131.0867, 3126.8394, 3132.6208, 3146.4167, 3147.3271, 3107.2598, 3080.0115, 3017.535, 3013.1333, 3077.357, 3041.0103, 3079.1453, 3091.696, 3044.9348, 3051.5828, 2979.2537, 2970.832, 2958.3318, 3017.5322, 3003.7554, 3029.2493, 3102.939, 3143.248, 3134.6992, 3057.333, 3061.6714, 3083.4414, 3139.8645, 3197.6035, 3176.2163, 3198.2634, 3171.839, 3285.0635, 3278.3083, 3275.6104, 3366.6301, 3396.6792, 3412.3193, 3386.1565, 3372.39, 3299.428, 3253.0552, 3294.023, 3243.7063, 3235.4688, 3299.7075, 3330.225, 3281.8772, 3313.0854, 3351.395, 3341.9128, 3371.1204, 3331.273, 3338.0225, 3377.9421, 3406.3179, 3378.0093, 3399.0125, 3468.688, 3501.3164, 3504.7947, 3501.3423, 3498.0103, 3557.5889, 3666.172, 3723.3965, 3690.642, 3711.07, 3693.9407, 3699.5623, 3633.1, 3592.297, 3584.5962, 3621.3442, 3658.3928, 3672.1975, 3730.0461, 3770.1401, 3779.508, 3743.935, 3714.008, 3674.7078, 3689.5203, 3753.38, 3699.0054, 3698.1592, 3632.7551, 3623.5264, 3674.9668, 3691.5735, 3699.0928, 3657.7485, 3626.968, 3653.2764, 3644.9756, 3683.7686, 3691.783, 3709.7876, 3711.188, 3795.7773, 3799.892, 3798.794, 3830.0933, 3792.4507, 3824.2646, 3873.1628, 3909.4333, 3874.8728, 3893.551, 3978.0522, 4025.6885, 4079.0986, 4037.7307, 4090.8586, 4073.347, 4056.9536, 4073.4421, 4021.498, 4046.1055, 4099.246, 4121.6606, 4185.4526, 4182.185, 4095.1965, 4089.0798, 4174.2227, 4183.887, 4110.28, 4093.057, 3997.882, 3935.9946, 3818.477, 3844.5657, 3784.0486, 3799.2607, 3894.033, 3928.1846, 4022.5618, 4018.5715, 3978.7444, 4055.68, 4102.341, 4134.623, 4114.862, 4087.4353, 3985.5796, 3965.753, 4053.1335, 4063.3965, 3982.6868, 3945.533, 3986.554, 3978.7214, 3936.4487, 3948.1357, 3971.2778, 4019.223, 4009.8892, 4150.791, 4226.78, 4205.308, 4251.132, 4242.6284, 4247.103, 4188.052, 4203.284, 4143.2397, 4109.669, 4097.353, 4120.078, 4042.4294, 4091.024, 4218.451, 4342.827, 4353.927, 4388.8345, 4339.6157, 4334.111, 4444.586, 4506.0063, 4525.7744, 4544.071, 4550.645, 4551.0312, 4562.532, 4529.0234, 4557.117, 4485.8823, 4512.898, 4550.98, 4640.692, 4731.638, 4647.7446, 4774.956, 4781.5415, 4795.1245, 4775.9995, 4849.62, 4818.8286, 4851.154, 4851.9253, 4905.237, 4943.4326, 4912.9995, 4864.245, 4655.4907, 4501.9756, 4529.8643, 4568.5933, 4534.8687, 4442.73, 4355.595, 4371.686, 4351.577, 4413.9683, 4434.434, 4433.9287, 4470.5854, 4484.5347, 4502.024, 4455.152, 4428.319, 4417.3457, 4490.6426, 4466.7856, 4636.1196, 4666.991, 4782.8975, 4999.309, 5068.6587, 5066.04, 5085.0396, 5107.738, 5120.3955, 5069.919, 5052.912, 5064.4307, 5097.4995, 4951.025, 4805.6465, 4865.2227, 4688.0293, 4654.503, 4656.522, 4770.922, 4685.301, 4704.5103, 4727.6875, 4766.679, 4783.928, 4725.918, 4790.652, 4742.44, 4638.0547, 4710.904, 4686.9106, 4768.4966, 4758.033, 4625.149, 4597.1167, 4640.2827, 4659.7637, 4727.2637, 4574.9355, 4595.584, 4600.143, 4594.2324, 4727.386, 4761.404, 4807.469, 4817.2114, 4818.719, 4910.59, 4984.668, 4970.888, 4981.096, 5046.8755, 4945.7583, 4906.962, 4875.8555, 4938.2617, 5011.0303, 5099.527, 4951.0127, 4964.945, 5015.0815, 5054.444, 5141.799]

score,pvalue,_ = coint(pred_extra,actual)
print(score,pvalue)


score,pvalue,_ = coint(pred_normal,actual)
print(score,pvalue)









